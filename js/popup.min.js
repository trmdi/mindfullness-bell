function invitebell(){chrome.storage.local.set({doRingBell:!0},function(){isdebug&&console.log("Pop-Up: Set to invite bell")})}function changeTimeSpace(){time_space_option=document.getElementById("timespace").selectedIndex,chrome.storage.local.set({timeSpaceOption:time_space_option},function(){isdebug&&console.log("Pop-Up: Saved time_space_option")}),chrome.storage.local.set({timeSpaceChanged:!0},function(){isdebug&&console.log("Pop-Up: Saved timeSpaceChanged")})}function changeNumbOfBells(){numbOfBells=document.getElementById("numOfBells").selectedIndex,chrome.storage.local.set({numbOfBells:numbOfBells},function(){isdebug&&console.log("Pop-Up: Saved numbOfBells")}),chrome.storage.local.set({numBellsChanged:!0},function(){isdebug&&console.log("Pop-Up: Saved numBellsChanged")})}function updateTime(){chrome.storage.local.get("TimeRemain",function(e){null!=e.TimeRemain&&(timer=e.TimeRemain)}),writeTime(),setTimeout(updateTime,100)}function resetTime(){timer=60*time_space}function initTimer(){updateTime()}function writeTime(){var e="",n="";e+=""+Math.floor(timer/60),1==e.length&&(e="0"+e),e+=":",n+=timer%60,1==n.length&&(n="0"+n),e+=n,$("#timeleft").each(function(){this.value=e})}function changeVolume(){document.getElementById("volume_txt").value=""+document.getElementById("volume").value+"%",volume=document.getElementById("volume").value,chrome.storage.local.set({volume:volume},function(){isdebug&&console.log("Pop-Up: Saved volume",volume)}),chrome.storage.local.set({volumeChanged:!0},function(){isdebug&&console.log("Pop-Up: Saved volumeChanged")})}function setBellEnable(){isBellEnabled=document.getElementById("isBellEnabledSwitch").checked,isdebug&&console.log("Background: isBellEnabled: "+isBellEnabled),isBellEnabled?($("#onLayer").css("display","block"),$("#offLayer").css("display","none")):($("#onLayer").css("display","none"),$("#offLayer").css("display","block")),chrome.storage.local.set({isBellEnabled:isBellEnabled},function(){isdebug&&console.log("Background: Saved isBellEnabled")})}function getHtmlVer(){var e=navigator.appCodeName,n=navigator.userAgent,t=0;for(n=n.substring((n+e).toLowerCase().indexOf(e.toLowerCase())),n=n.substring(e.length);" "==n.substring(0,1)||"/"==n.substring(0,1);)n=n.substring(1);for(var l=0;"0123456789.+-".indexOf((n+"?").substring(l,l+1))>=0;)l+=1;return n=n.substring(0,l),isNaN(n)||n>0&&(t=n),t}function updateData(){document.getElementById("timespace").selectedIndex=time_space_option,document.getElementById("numOfBells").selectedIndex=numbOfBells,document.getElementById("volume").value=volume,document.getElementById("volume_txt").value=""+document.getElementById("volume").value+"%",document.getElementById("isBellEnabledSwitch").checked=isBellEnabled,document.getElementById("volume").onchange=changeVolume,document.getElementById("timespace").onchange=changeTimeSpace,document.getElementById("numOfBells").onchange=changeNumbOfBells,document.getElementById("invitebell").onclick=invitebell,document.getElementById("thichNhatHanh").onclick=invitebell,document.getElementById("isBellEnabledSwitch").onclick=setBellEnable,document.getElementById("offLayer").style.height=document.getElementById("onLayer").offsetHeight,setBellEnable(),isdebug&&console.log("UpdateNow")}function setLocalization(){var e=chrome.i18n.getMessage;document.title=e("bellTitle"),$("#bellTitle").each(function(){this.innerHTML=e("bellTitle")}),$("#RemainingTime").each(function(){this.innerHTML=e("RemainingTime"),this.title=e("RemainingTime_Tooltip")}),$("#TimeBetweenBells").each(function(){this.innerHTML=e("TimeBetweenBells"),this.title=e("TimeBetweenBells_Tooltip")}),$("#_5min_").each(function(){this.innerHTML=e("_5min_")}),$("#_10min_").each(function(){this.innerHTML=e("_10min_")}),$("#_15min_").each(function(){this.innerHTML=e("_15min_")}),$("#_20min_").each(function(){this.innerHTML=e("_20min_")}),$("#_30min_").each(function(){this.innerHTML=e("_30min_")}),$("#_45min_").each(function(){this.innerHTML=e("_45min_")}),$("#_60min_").each(function(){this.innerHTML=e("_60min_")}),$("#numOfBellsLabel").each(function(){this.innerHTML=e("NumOfBellsLabel"),this.title=e("NumOfBells_Tooltip")}),$("#VolumeLabel").each(function(){this.innerHTML=e("VolumeLabel"),this.title=e("Volume_Tooltip")}),$("#invitebell").each(function(){this.value=e("InviteBell")}),$("#BellIsOff").each(function(){this.innerHTML=e("BellIsOff")}),$("#BellOfMindfulnessPurpose").each(function(){this.innerHTML=e("BellOfMindfulnessPurpose")}),$("#DesignCredit").each(function(){this.innerHTML=e("DesignCredit")}),$("#ExtAuthor").each(function(){this.innerHTML=e("extAuthor")}),$("#TranslateCredit").each(function(){this.innerHTML=e("TranslateCredit")}),$("#InspirationTxt").each(function(){this.innerHTML=e("InspirationTxt")}),$("#InspirationCredit").each(function(){this.innerHTML=e("InspirationCredit")}),$("#DonationTextH4").each(function(){this.innerHTML=e("DonationTextH4")}),$("#DonationText").each(function(){this.innerHTML=e("DonationText")}),$("#DonationButton").each(function(){this.value=e("DonationButton"),this.title=e("DonationButton_Tooltip")}),$("#isBellEnabledSwitch").each(function(){this.title=e("isBellEnabledSwitch_Tooltip"),$(this).children().each(function(){this.title=e("isBellEnabledSwitch_Tooltip"),$(this).children().each(function(){this.title=e("isBellEnabledSwitch_Tooltip")})})}),$("#timeleft").each(function(){this.title=e("RemainingTime_Tooltip")}),$("#timespace").each(function(){this.title=e("TimeBetweenBells_Tooltip")}),$("#volume").each(function(){this.title=e("Volume_Tooltip")}),$("#volume_txt").each(function(){this.title=e("Volume_Tooltip")}),$("#invitebell").each(function(){this.title=e("InviteBell_Tooltip")}),$("#numbOfBells").each(function(){this.title=e("NumOfBells_Tooltip")})}function loadData(){var e=new Array;e[0]="timeSpaceOption",e[1]="volume",e[2]="isBellEnabled",e[3]="numbOfBells",chrome.storage.local.get(e,function(e){null==e.timeSpaceOption?chrome.storage.local.set({timeSpaceOption:time_space_option},function(){isdebug&&console.log("POPUP: Saved time_space_option")}):(time_space_option=e.timeSpaceOption,isdebug&&console.log("POPUP: timeSpaceOption",e.timeSpaceOption)),null==e.volume?chrome.storage.local.set({volume:volume},function(){isdebug&&console.log("POPUP: Saved volume")}):(volume=e.volume,isdebug&&console.log("POPUP: volume: ",e.volume)),null==e.isBellEnabled?chrome.storage.local.set({isBellEnabled:isBellEnabled},function(){isdebug&&console.log("POPUP: Saved isBellEnabled")}):(isBellEnabled=e.isBellEnabled,isdebug&&console.log("POPUP: isBellEnabled: ",isBellEnabled)),null==e.numbOfBells?chrome.storage.local.set({numbOfBells:numbOfBells},function(){isdebug&&console.log("POPUP: Saved numbOfBells")}):(numbOfBells=e.numbOfBells,isdebug&&console.log("POPUP: numbOfBells",e.numbOfBells)),updateData(),initTimer()})}var isBellEnabled=!0,time_space_option=2,volume=30,timer=0,time_space=3,timer_str="",volume,numbOfBells=3,HTMLver=getHtmlVer(),isdebug=!1;document.addEventListener("DOMContentLoaded",function(){setLocalization(),loadData()}),$(".DonationHidingButton").each(function(){this.onclick=function(){$(".DonationLayer").css("height","100px"),$(".DonationLayer").css("min-height","100px"),$(".DonationLayer").css("max-height","100px"),setTimeout(function(){$(document.body).scrollTop($("#DonationButton").offset().top)},700)}});